var root=this,Readability=function(e,t,i){i=i||{},this._uri=e,this._doc=t,this._biggestFrame=!1,this._articleByline=null,this._articleDir=null,this._debug=!!i.debug,this._maxElemsToParse=i.maxElemsToParse||this.DEFAULT_MAX_ELEMS_TO_PARSE,this._nbTopCandidates=i.nbTopCandidates||this.DEFAULT_N_TOP_CANDIDATES,this._maxPages=i.maxPages||this.DEFAULT_MAX_PAGES,this._flags=this.FLAG_STRIP_UNLIKELYS|this.FLAG_WEIGHT_CLASSES|this.FLAG_CLEAN_CONDITIONALLY,this._parsedPages={},this._pageETags={},this._curPageNum=1
var n
this._debug?(n=function(e){var t=e.nodeName+" "
if(e.nodeType==e.TEXT_NODE)return t+'("'+e.textContent+'")'
var i=e.className&&"."+e.className.replace(/ /g,"."),n=""
return e.id?n="(#"+e.id+i+")":i&&(n="("+i+")"),t+n},this.log=function(){if("dump"in root){var e=Array.prototype.map.call(arguments,function(e){return e&&e.nodeName?n(e):e}).join(" ")
dump("Reader: (Readability) "+e+"\n")}else if("console"in root){var t=["Reader: (Readability) "].concat(arguments)
console.log.apply(console,t)}}):this.log=function(){}}
Readability.prototype={FLAG_STRIP_UNLIKELYS:1,FLAG_WEIGHT_CLASSES:2,FLAG_CLEAN_CONDITIONALLY:4,DEFAULT_MAX_ELEMS_TO_PARSE:0,DEFAULT_N_TOP_CANDIDATES:5,DEFAULT_MAX_PAGES:5,DEFAULT_TAGS_TO_SCORE:"section,h2,h3,h4,h5,h6,p,td,pre".toUpperCase().split(","),REGEXPS:{unlikelyCandidates:/banner|combx|comment|community|disqus|extra|foot|header|menu|modal|related|remark|rss|share|shoutbox|sidebar|skyscraper|sponsor|ad-break|agegate|pagination|pager|popup/i,okMaybeItsACandidate:/and|article|body|column|main|shadow/i,positive:/article|body|content|entry|hentry|main|page|pagination|post|text|blog|story/i,negative:/hidden|^hid$| hid$| hid |^hid |banner|combx|comment|com-|contact|foot|footer|footnote|masthead|media|meta|modal|outbrain|promo|related|scroll|share|shoutbox|sidebar|skyscraper|sponsor|shopping|tags|tool|widget/i,extraneous:/print|archive|comment|discuss|e[\-]?mail|share|reply|all|login|sign|single|utility/i,byline:/byline|author|dateline|writtenby/i,replaceFonts:/<(\/?)font[^>]*>/gi,normalize:/\s{2,}/g,videos:/\/\/(www\.)?(dailymotion|youtube|youtube-nocookie|player\.vimeo)\.com/i,nextLink:/(next|weiter|continue|>([^\|]|$)|([^\|]|$))/i,prevLink:/(prev|earl|old|new|<|)/i,whitespace:/^\s*$/,hasContent:/\S$/},DIV_TO_P_ELEMS:["A","BLOCKQUOTE","DL","DIV","IMG","OL","P","PRE","TABLE","UL","SELECT"],ALTER_TO_DIV_EXCEPTIONS:["DIV","ARTICLE","SECTION","P"],_postProcessContent:function(e){this._fixRelativeUris(e)},_forEachNode:function(e,t){return Array.prototype.forEach.call(e,t,this)},_someNode:function(e,t){return Array.prototype.some.call(e,t,this)},_concatNodeLists:function(){var e=Array.prototype.slice,t=e.call(arguments),i=t.map(function(t){return e.call(t)})
return Array.prototype.concat.apply([],i)},_getAllNodesWithTag:function(e,t){return e.querySelectorAll?e.querySelectorAll(t.join(",")):[].concat.apply([],t.map(function(t){var i=e.getElementsByTagName(t)
return Array.isArray(i)?i:Array.from(i)}))},_fixRelativeUris:function(e){function t(e){return/^[a-zA-Z][a-zA-Z0-9\+\-\.]*:/.test(e)?e:"//"==e.substr(0,2)?i+"://"+e.substr(2):"/"==e[0]?n+e:0===e.indexOf("./")?a+e.slice(2):"#"==e[0]?e:a+e}var i=this._uri.scheme,n=this._uri.prePath,a=this._uri.pathBase,r=e.getElementsByTagName("a")
this._forEachNode(r,function(e){var i=e.getAttribute("href")
if(i)if(0===i.indexOf("javascript:")){var n=this._doc.createTextNode(e.textContent)
e.parentNode.replaceChild(n,e)}else e.setAttribute("href",t(i))})
var s=e.getElementsByTagName("img")
this._forEachNode(s,function(e){var i=e.getAttribute("src")
i&&e.setAttribute("src",t(i))})},_getArticleTitle:function(){var e=this._doc,t="",i=""
try{t=i=e.title,"string"!=typeof t&&(t=i=this._getInnerText(e.getElementsByTagName("title")[0]))}catch(n){}if(t.match(/ [\|\-] /))t=i.replace(/(.*)[\|\-] .*/gi,"$1"),t.split(" ").length<3&&(t=i.replace(/[^\|\-]*[\|\-](.*)/gi,"$1"))
else if(-1!==t.indexOf(": ")){var a=this._concatNodeLists(e.getElementsByTagName("h1"),e.getElementsByTagName("h2")),r=this._someNode(a,function(e){return e.textContent===t})
r||(t=i.substring(i.lastIndexOf(":")+1),t.split(" ").length<3&&(t=i.substring(i.indexOf(":")+1)))}else if(t.length>150||t.length<15){var s=e.getElementsByTagName("h1")
1===s.length&&(t=this._getInnerText(s[0]))}return t=t.trim(),t.split(" ").length<=4&&(t=i),t},_prepDocument:function(){var e=this._doc
this._forEachNode(e.getElementsByTagName("style"),function(e){e.parentNode.removeChild(e)}),e.body&&this._replaceBrs(e.body),this._forEachNode(e.getElementsByTagName("font"),function(e){this._setNodeTag(e,"SPAN")})},_nextElement:function(e){for(var t=e;t&&t.nodeType!=Node.ELEMENT_NODE&&this.REGEXPS.whitespace.test(t.textContent);)t=t.nextSibling
return t},_replaceBrs:function(e){this._forEachNode(e.getElementsByTagName("br"),function(e){for(var t=e.nextSibling,i=!1;(t=this._nextElement(t))&&"BR"==t.tagName;){i=!0
var n=t.nextSibling
t.parentNode.removeChild(t),t=n}if(i){var a=this._doc.createElement("p")
for(e.parentNode.replaceChild(a,e),t=a.nextSibling;t;){if("BR"==t.tagName){var r=this._nextElement(t)
if(r&&"BR"==r.tagName)break}var s=t.nextSibling
a.appendChild(t),t=s}}})},_setNodeTag:function(e,t){if(this.log("_setNodeTag",e,t),e.__JSDOMParser__)return e.localName=t.toLowerCase(),e.tagName=t.toUpperCase(),e
for(var i=e.ownerDocument.createElement(t);e.firstChild;)i.appendChild(e.firstChild)
e.parentNode.replaceChild(i,e),e.readability&&(i.readability=e.readability)
for(var n=0;n<e.attributes.length;n++)i.setAttribute(e.attributes[n].name,e.attributes[n].value)
return i},_prepArticle:function(e){this._cleanStyles(e),this._cleanConditionally(e,"form"),this._clean(e,"object"),this._clean(e,"embed"),this._clean(e,"h1"),this._clean(e,"footer"),1===e.getElementsByTagName("h2").length&&this._clean(e,"h2"),this._clean(e,"iframe"),this._cleanHeaders(e),this._cleanConditionally(e,"table"),this._cleanConditionally(e,"ul"),this._cleanConditionally(e,"div"),this._forEachNode(e.getElementsByTagName("p"),function(e){var t=e.getElementsByTagName("img").length,i=e.getElementsByTagName("embed").length,n=e.getElementsByTagName("object").length,a=e.getElementsByTagName("iframe").length,r=t+i+n+a
0!==r||this._getInnerText(e,!1)||e.parentNode.removeChild(e)}),this._forEachNode(e.getElementsByTagName("br"),function(e){var t=this._nextElement(e.nextSibling)
t&&"P"==t.tagName&&e.parentNode.removeChild(e)})},_initializeNode:function(e){switch(e.readability={contentScore:0},e.tagName){case"DIV":e.readability.contentScore+=5
break
case"PRE":case"TD":case"BLOCKQUOTE":e.readability.contentScore+=3
break
case"ADDRESS":case"OL":case"UL":case"DL":case"DD":case"DT":case"LI":case"FORM":e.readability.contentScore-=3
break
case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"TH":e.readability.contentScore-=5}e.readability.contentScore+=this._getClassWeight(e)},_removeAndGetNext:function(e){var t=this._getNextNode(e,!0)
return e.parentNode.removeChild(e),t},_getNextNode:function(e,t){if(!t&&e.firstElementChild)return e.firstElementChild
if(e.nextElementSibling)return e.nextElementSibling
do e=e.parentNode
while(e&&!e.nextElementSibling)
return e&&e.nextElementSibling},_getNextNodeNoElementProperties:function(e,t){function i(e){do e=e.nextSibling
while(e&&e.nodeType!==e.ELEMENT_NODE)
return e}if(!t&&e.children[0])return e.children[0]
var n=i(e)
if(n)return n
do e=e.parentNode,e&&(n=i(e))
while(e&&!n)
return e&&n},_checkByline:function(e,t){if(this._articleByline)return!1
if(void 0!==e.getAttribute)var i=e.getAttribute("rel")
return("author"===i||this.REGEXPS.byline.test(t))&&this._isValidByline(e.textContent)?(this._articleByline=e.textContent.trim(),!0):!1},_getNodeAncestors:function(e,t){t=t||0
for(var i=0,n=[];e.parentNode&&(n.push(e.parentNode),!t||++i!==t);)e=e.parentNode
return n},_grabArticle:function(e){this.log("**** grabArticle ****")
var t=this._doc,i=null!==e
if(e=e?e:this._doc.body,!e)return this.log("No body found in document. Abort."),null
var n=e.innerHTML
for(this._articleDir=t.documentElement.getAttribute("dir");;){for(var a=this._flagIsActive(this.FLAG_STRIP_UNLIKELYS),r=[],s=this._doc.documentElement;s;){var o=s.className+" "+s.id
if(this._checkByline(s,o))s=this._removeAndGetNext(s)
else if(a&&this.REGEXPS.unlikelyCandidates.test(o)&&!this.REGEXPS.okMaybeItsACandidate.test(o)&&"BODY"!==s.tagName&&"A"!==s.tagName)this.log("Removing unlikely candidate - "+o),s=this._removeAndGetNext(s)
else{if(-1!==this.DEFAULT_TAGS_TO_SCORE.indexOf(s.tagName)&&r.push(s),"DIV"===s.tagName)if(this._hasSinglePInsideElement(s)){var l=s.children[0]
s.parentNode.replaceChild(l,s),s=l}else this._hasChildBlockElement(s)?this._forEachNode(s.childNodes,function(e){if(e.nodeType===Node.TEXT_NODE){var i=t.createElement("p")
i.textContent=e.textContent,i.style.display="inline",i.className="readability-styled",s.replaceChild(i,e)}}):(s=this._setNodeTag(s,"P"),r.push(s))
s=this._getNextNode(s)}}var c=[]
this._forEachNode(r,function(e){if(e.parentNode&&"undefined"!=typeof e.parentNode.tagName){var t=this._getInnerText(e)
if(!(t.length<25)){var i=this._getNodeAncestors(e,3)
if(0!==i.length){var n=0
n+=1,n+=t.split(",").length,n+=Math.min(Math.floor(t.length/100),3),this._forEachNode(i,function(e,t){if(e.tagName){if("undefined"==typeof e.readability&&(this._initializeNode(e),c.push(e)),0===t)var i=1
else i=1===t?2:3*t
e.readability.contentScore+=n/i}})}}}})
for(var h=[],d=0,g=c.length;g>d;d+=1){var p=c[d],u=p.readability.contentScore*(1-this._getLinkDensity(p))
p.readability.contentScore=u,this.log("Candidate:",p,"with score "+u)
for(var _=0;_<this._nbTopCandidates;_++){var m=h[_]
if(!m||u>m.readability.contentScore){h.splice(_,0,p),h.length>this._nbTopCandidates&&h.pop()
break}}}var f=h[0]||null,E=!1
if(null===f||"BODY"===f.tagName){f=t.createElement("DIV"),E=!0
for(var N=e.childNodes;N.length;)this.log("Moving child out:",N[0]),f.appendChild(N[0])
e.appendChild(f),this._initializeNode(f)}else if(f)for(var y=f.parentNode,v=f.readability.contentScore,T=v/3;y&&y.readability;){var b=y.readability.contentScore
if(T>b)break
if(b>v){f=y
break}v=y.readability.contentScore,y=y.parentNode}var A=t.createElement("DIV")
i&&(A.id="readability-content")
for(var S=Math.max(10,.2*f.readability.contentScore),x=f.parentNode.children,C=0,L=x.length;L>C;C++){var P=x[C],I=!1
if(this.log("Looking at sibling node:",P,P.readability?"with score "+P.readability.contentScore:""),this.log("Sibling has score",P.readability?P.readability.contentScore:"Unknown"),P===f)I=!0
else{var B=0
if(P.className===f.className&&""!==f.className&&(B+=.2*f.readability.contentScore),P.readability&&P.readability.contentScore+B>=S)I=!0
else if("P"===P.nodeName){var R=this._getLinkDensity(P),D=this._getInnerText(P),G=D.length
G>80&&.25>R?I=!0:80>G&&G>0&&0===R&&-1!==D.search(/\.( |$)/)&&(I=!0)}}I&&(this.log("Appending node:",P),-1===this.ALTER_TO_DIV_EXCEPTIONS.indexOf(P.nodeName)&&(this.log("Altering sibling:",P,"to div."),P=this._setNodeTag(P,"DIV")),A.appendChild(P),C-=1,L-=1)}if(this._debug&&this.log("Article content pre-prep: "+A.innerHTML),this._prepArticle(A),this._debug&&this.log("Article content post-prep: "+A.innerHTML),1===this._curPageNum)if(E)f.id="readability-page-1",f.className="page"
else{var O=t.createElement("DIV")
O.id="readability-page-1",O.className="page"
for(var M=A.childNodes;M.length;)O.appendChild(M[0])
A.appendChild(O)}if(this._debug&&this.log("Article content after paging: "+A.innerHTML),!(this._getInnerText(A,!0).length<500))return A
if(e.innerHTML=n,this._flagIsActive(this.FLAG_STRIP_UNLIKELYS))this._removeFlag(this.FLAG_STRIP_UNLIKELYS)
else if(this._flagIsActive(this.FLAG_WEIGHT_CLASSES))this._removeFlag(this.FLAG_WEIGHT_CLASSES)
else{if(!this._flagIsActive(this.FLAG_CLEAN_CONDITIONALLY))return null
this._removeFlag(this.FLAG_CLEAN_CONDITIONALLY)}}},_isValidByline:function(e){return"string"==typeof e||e instanceof String?(e=e.trim(),e.length>0&&e.length<100):!1},_getArticleMetadata:function(){var e={},t={},i=this._doc.getElementsByTagName("meta"),n=/^\s*((twitter)\s*:\s*)?(description|title)\s*$/gi,a=/^\s*og\s*:\s*(description|title)\s*$/gi
return this._forEachNode(i,function(i){var r=i.getAttribute("name"),s=i.getAttribute("property")
if(-1!==[r,s].indexOf("author"))return void(e.byline=i.getAttribute("content"))
var o=null
if(n.test(r)?o=r:a.test(s)&&(o=s),o){var l=i.getAttribute("content")
l&&(o=o.toLowerCase().replace(/\s/g,""),t[o]=l.trim())}}),"description"in t?e.excerpt=t.description:"og:description"in t?e.excerpt=t["og:description"]:"twitter:description"in t&&(e.excerpt=t["twitter:description"]),"og:title"in t?e.title=t["og:title"]:"twitter:title"in t&&(e.title=t["twitter:title"]),e},_removeScripts:function(e){this._forEachNode(e.getElementsByTagName("script"),function(e){e.nodeValue="",e.removeAttribute("src"),e.parentNode&&e.parentNode.removeChild(e)}),this._forEachNode(e.getElementsByTagName("noscript"),function(e){e.parentNode&&e.parentNode.removeChild(e)})},_hasSinglePInsideElement:function(e){return 1!=e.children.length||"P"!==e.children[0].tagName?!1:!this._someNode(e.childNodes,function(e){return e.nodeType===Node.TEXT_NODE&&this.REGEXPS.hasContent.test(e.textContent)})},_hasChildBlockElement:function(e){return this._someNode(e.childNodes,function(e){return-1!==this.DIV_TO_P_ELEMS.indexOf(e.tagName)||this._hasChildBlockElement(e)})},_getInnerText:function(e,t){t="undefined"==typeof t?!0:t
var i=e.textContent.trim()
return t?i.replace(this.REGEXPS.normalize," "):i},_getCharCount:function(e,t){return t=t||",",this._getInnerText(e).split(t).length-1},_cleanStyles:function(e){if(e=e||this._doc){var t=e.firstChild
for("function"==typeof e.removeAttribute&&"readability-styled"!==e.className&&e.removeAttribute("style");null!==t;)t.nodeType===t.ELEMENT_NODE&&("readability-styled"!==t.className&&t.removeAttribute("style"),this._cleanStyles(t)),t=t.nextSibling}},_getLinkDensity:function(e){var t=this._getInnerText(e).length
if(0===t)return 0
var i=0
return this._forEachNode(e.getElementsByTagName("a"),function(e){i+=this._getInnerText(e).length}),i/t},_findBaseUrl:function(){for(var e=this._uri,t=e.path.split("?")[0],i=t.split("/").reverse(),n=[],a="",r=0,s=i.length;s>r;r+=1){var o=i[r];-1!==o.indexOf(".")&&(a=o.split(".")[1],a.match(/[^a-zA-Z]/)||(o=o.split(".")[0])),-1!==o.indexOf(",00")&&(o=o.replace(",00","")),!o.match(/((_|-)?p[a-z]*|(_|-))[0-9]{1,2}$/i)||1!==r&&0!==r||(o=o.replace(/((_|-)?p[a-z]*|(_|-))[0-9]{1,2}$/i,""))
var l=!1
2>r&&o.match(/^\d{1,2}$/)&&(l=!0),0===r&&"index"===o.toLowerCase()&&(l=!0),2>r&&o.length<3&&!i[0].match(/[a-z]/i)&&(l=!0),l||n.push(o)}return e.scheme+"://"+e.host+n.reverse().join("/")},_findNextPageLink:function(e){for(var t=this._uri,i={},n=e.getElementsByTagName("a"),a=this._findBaseUrl(),r=0,s=n.length;s>r;r+=1){var o=n[r],l=n[r].href.replace(/#.*$/,"").replace(/\/$/,"")
if(!(""===l||l===a||l===t.spec||l in this._parsedPages)&&t.host===l.split(/\/+/g)[1]){var c=this._getInnerText(o)
if(!(c.match(this.REGEXPS.extraneous)||c.length>25)){var h=l.replace(a,"")
if(h.match(/\d/)){l in i?i[l].linkText+=" | "+c:i[l]={score:0,linkText:c,href:l}
var d=i[l]
0!==l.indexOf(a)&&(d.score-=25)
var g=c+" "+o.className+" "+o.id
g.match(this.REGEXPS.nextLink)&&(d.score+=50),g.match(/pag(e|ing|inat)/i)&&(d.score+=25),g.match(/(first|last)/i)&&(d.linkText.match(this.REGEXPS.nextLink)||(d.score-=65)),(g.match(this.REGEXPS.negative)||g.match(this.REGEXPS.extraneous))&&(d.score-=50),g.match(this.REGEXPS.prevLink)&&(d.score-=200)
for(var p=o.parentNode,u=!1,_=!1;p;){var m=p.className+" "+p.id
!u&&m&&m.match(/pag(e|ing|inat)/i)&&(u=!0,d.score+=25),!_&&m&&m.match(this.REGEXPS.negative)&&(m.match(this.REGEXPS.positive)||(d.score-=25,_=!0)),p=p.parentNode}(l.match(/p(a|g|ag)?(e|ing|ination)?(=|\/)[0-9]{1,2}/i)||l.match(/(page|paging)/i))&&(d.score+=25),l.match(this.REGEXPS.extraneous)&&(d.score-=15)
var f=parseInt(c,10)
f&&(1===f?d.score-=10:d.score+=Math.max(0,10-f))}}}}var E=null
for(var N in i)i.hasOwnProperty(N)&&i[N].score>=50&&(!E||E.score<i[N].score)&&(E=i[N])
if(E){var y=E.href.replace(/\/$/,"")
return this.log("NEXT PAGE IS "+y),this._parsedPages[y]=!0,y}return null},_successfulRequest:function(e){return e.status>=200&&e.status<300||304===e.status||0===e.status&&e.responseText},_ajax:function(e,t){function i(e){4===n.readyState&&(this._successfulRequest(n)?t.success&&t.success(n):t.error&&t.error(n))}var n=new XMLHttpRequest
"undefined"==typeof t&&(t={}),n.onreadystatechange=i,n.open("get",e,!0),n.setRequestHeader("Accept","text/html")
try{n.send(t.postBody)}catch(a){t.error&&t.error()}return n},_appendNextPage:function(e){var t=this._doc
this._curPageNum+=1
var i=t.createElement("DIV")
if(i.id="readability-page-"+this._curPageNum,i.className="page",i.innerHTML='<p class="page-separator" title="Page '+this._curPageNum+'">&sect;</p>',t.getElementById("readability-content").appendChild(i),this._curPageNum>this._maxPages){var n="<div style='text-align: center'><a href='"+e+"'>View Next Page</a></div>"
return void(i.innerHTML=i.innerHTML+n)}(function(e,n){this._ajax(e,{success:function(a){var r=a.getResponseHeader("ETag")
if(r){if(r in this._pageETags)return this.log("Exact duplicate page found via ETag. Aborting."),void(i.style.display="none")
this._pageETags[r]=1}var s=t.createElement("DIV"),o=a.responseText.replace(/\n/g,"").replace(/<script.*?>.*?<\/script>/gi,"")
o=o.replace(/\n/g,"").replace(/<script.*?>.*?<\/script>/gi,""),o=o.replace(/<(\/?)noscript/gi,"<$1div"),o=o.replace(this.REGEXPS.replaceFonts,"<$1span>"),s.innerHTML=o,this._replaceBrs(s),this._flags=7
var l=this._findNextPageLink(s),c=this._grabArticle(s)
if(!c)return void this.log("No content found in page to append. Aborting.")
var h=c.getElementsByTagName("P").length?c.getElementsByTagName("P")[0]:null
if(h&&h.innerHTML.length>100)for(var d=1;d<=this._curPageNum;d+=1){var g=t.getElementById("readability-page-"+d)
if(g&&-1!==g.innerHTML.indexOf(h.innerHTML))return this.log("Duplicate of page "+d+" - skipping."),i.style.display="none",void(this._parsedPages[e]=!0)}this._removeScripts(c),n.innerHTML=n.innerHTML+c.innerHTML,setTimeout(function(){this._postProcessContent(n)}.bind(this),500),l&&this._appendNextPage(l)}})}).bind(this)(e,i)},_getClassWeight:function(e){if(!this._flagIsActive(this.FLAG_WEIGHT_CLASSES))return 0
var t=0
return"string"==typeof e.className&&""!==e.className&&(this.REGEXPS.negative.test(e.className)&&(t-=25),this.REGEXPS.positive.test(e.className)&&(t+=25)),"string"==typeof e.id&&""!==e.id&&(this.REGEXPS.negative.test(e.id)&&(t-=25),this.REGEXPS.positive.test(e.id)&&(t+=25)),t},_clean:function(e,t){var i=-1!==["object","embed","iframe"].indexOf(t)
this._forEachNode(e.getElementsByTagName(t),function(e){if(i){var t=[].map.call(e.attributes,function(e){return e.value}).join("|")
if(this.REGEXPS.videos.test(t))return
if(this.REGEXPS.videos.test(e.innerHTML))return}e.parentNode.removeChild(e)})},_hasAncestorTag:function(e,t,i){i=i||3,t=t.toUpperCase()
for(var n=0;e.parentNode;){if(n>i)return!1
if(e.parentNode.tagName===t)return!0
e=e.parentNode,n++}return!1},_cleanConditionally:function(e,t){if(this._flagIsActive(this.FLAG_CLEAN_CONDITIONALLY))for(var i=e.getElementsByTagName(t),n=i.length,a="ul"===t||"ol"===t,r=n-1;r>=0;r-=1){var s=this._getClassWeight(i[r]),o=0
if(this.log("Cleaning Conditionally",i[r]),0>s+o)i[r].parentNode.removeChild(i[r])
else if(this._getCharCount(i[r],",")<10){for(var l=i[r].getElementsByTagName("p").length,c=i[r].getElementsByTagName("img").length,h=i[r].getElementsByTagName("li").length-100,d=i[r].getElementsByTagName("input").length,g=0,p=i[r].getElementsByTagName("embed"),u=0,_=p.length;_>u;u+=1)this.REGEXPS.videos.test(p[u].src)||(g+=1)
var m=this._getLinkDensity(i[r]),f=this._getInnerText(i[r]).length,E=!1
c>l&&!this._hasAncestorTag(i[r],"figure")?E=!0:!a&&h>l?E=!0:d>Math.floor(l/3)?E=!0:!a&&25>f&&(0===c||c>2)?E=!0:!a&&25>s&&m>.2?E=!0:s>=25&&m>.5?E=!0:(1===g&&75>f||g>1)&&(E=!0),E&&i[r].parentNode.removeChild(i[r])}}},_cleanHeaders:function(e){for(var t=1;3>t;t+=1)for(var i=e.getElementsByTagName("h"+t),n=i.length-1;n>=0;n-=1)this._getClassWeight(i[n])<0&&i[n].parentNode.removeChild(i[n])},_flagIsActive:function(e){return(this._flags&e)>0},_addFlag:function(e){this._flags=this._flags|e},_removeFlag:function(e){this._flags=this._flags&~e},isProbablyReaderable:function(e){var t=this._getAllNodesWithTag(this._doc,["p","pre"]),i=0
return this._someNode(t,function(t){if(e&&!e(t))return!1
var n=t.className+" "+t.id
if(this.REGEXPS.unlikelyCandidates.test(n)&&!this.REGEXPS.okMaybeItsACandidate.test(n))return!1
if(t.matches&&t.matches("li p"))return!1
var a=t.textContent.trim().length
return 140>a?!1:(i+=Math.sqrt(a-140),i>20)})},parse:function(){if(this._maxElemsToParse>0){var e=this._doc.getElementsByTagName("*").length
if(e>this._maxElemsToParse)throw new Error("Aborting parsing document; "+e+" elements found")}"undefined"==typeof this._doc.documentElement.firstElementChild&&(this._getNextNode=this._getNextNodeNoElementProperties),this._removeScripts(this._doc),this._prepDocument()
var t=this._getArticleMetadata(),i=t.title||this._getArticleTitle(),n=this._grabArticle()
if(!n)return null
if(this.log("Grabbed: "+n.innerHTML),this._postProcessContent(n),!t.excerpt){var a=n.getElementsByTagName("p")
a.length>0&&(t.excerpt=a[0].textContent.trim())}var r=n.textContent
return{uri:this._uri,title:i,byline:t.byline||this._articleByline,dir:this._articleDir,content:n.innerHTML,textContent:r,length:r.length,excerpt:t.excerpt}}}
